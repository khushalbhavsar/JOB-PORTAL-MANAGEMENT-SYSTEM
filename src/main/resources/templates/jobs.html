<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse Jobs - Job Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .job-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .job-card {
            transition: all 0.3s;
        }

        .filter-sidebar {
            position: sticky;
            top: 80px;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="/">
                <i class="fas fa-briefcase me-2"></i>JobPortal
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="/jobs">Browse Jobs</a></li>
                    <li class="nav-item"><a class="nav-link" href="/companies">Companies</a></li>
                </ul>
                <ul class="navbar-nav" id="navAuth">
                    <li class="nav-item"><a class="nav-link" href="/login">Login</a></li>
                    <li class="nav-item"><a class="btn btn-light ms-2" href="/register">Register</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div style="padding-top: 80px;"></div>

    <div class="container py-4">
        <!-- Search Bar -->
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <form id="searchForm" class="row g-3">
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="keyword" placeholder="Job title or skills">
                    </div>
                    <div class="col-md-3">
                        <input type="text" class="form-control" id="location" placeholder="Location">
                    </div>
                    <div class="col-md-2">
                        <select class="form-select" id="jobType">
                            <option value="">Job Type</option>
                            <option value="FULL_TIME">Full Time</option>
                            <option value="PART_TIME">Part Time</option>
                            <option value="CONTRACT">Contract</option>
                            <option value="INTERNSHIP">Internship</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <select class="form-select" id="experienceLevel">
                            <option value="">Experience</option>
                            <option value="ENTRY">Entry Level</option>
                            <option value="MID">Mid Level</option>
                            <option value="SENIOR">Senior Level</option>
                        </select>
                    </div>
                    <div class="col-md-1">
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="row">
            <!-- Jobs List -->
            <div class="col-lg-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h4><span id="jobCount">0</span> Jobs Found</h4>
                    <div class="d-flex gap-2">
                        <select class="form-select form-select-sm" id="sortBy" style="width: auto;">
                            <option value="createdAt">Newest First</option>
                            <option value="viewsCount">Most Popular</option>
                            <option value="title">Title A-Z</option>
                        </select>
                    </div>
                </div>

                <div id="jobsList" class="row">
                    <!-- Jobs will be loaded here -->
                </div>

                <!-- Pagination -->
                <nav id="pagination" class="d-flex justify-content-center mt-4">
                    <ul class="pagination"></ul>
                </nav>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-primary text-white py-4 mt-5">
        <div class="container text-center">
            <p class="mb-0">&copy; 2024 Job Portal Management System</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentPage = 0;
        const pageSize = 12;

        // Dummy job listings data
        const dummyJobs = [
            {
                jobId: 1,
                title: 'Senior Java Developer',
                companyName: 'TechCorp Solutions',
                location: 'Bangalore, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'SENIOR',
                minSalary: 1500000,
                maxSalary: 2500000,
                skills: 'Java, Spring Boot, Microservices, MySQL, MongoDB',
                isRemote: false,
                viewsCount: 245,
                postedDate: '2026-01-05'
            },
            {
                jobId: 2,
                title: 'Python Data Scientist',
                companyName: 'DataDriven Analytics',
                location: 'Mumbai, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'MID',
                minSalary: 1200000,
                maxSalary: 2000000,
                skills: 'Python, TensorFlow, PyTorch, Pandas, Machine Learning',
                isRemote: true,
                viewsCount: 312,
                postedDate: '2026-01-08'
            },
            {
                jobId: 3,
                title: 'Full Stack Developer',
                companyName: 'Innovate Labs',
                location: 'Hyderabad, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'MID',
                minSalary: 800000,
                maxSalary: 1500000,
                skills: 'React, Node.js, JavaScript, TypeScript, MongoDB',
                isRemote: true,
                viewsCount: 189,
                postedDate: '2026-01-07'
            },
            {
                jobId: 4,
                title: 'DevOps Engineer',
                companyName: 'CloudNine Systems',
                location: 'Pune, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'MID',
                minSalary: 1000000,
                maxSalary: 1800000,
                skills: 'AWS, Docker, Kubernetes, Jenkins, Terraform',
                isRemote: false,
                viewsCount: 156,
                postedDate: '2026-01-06'
            },
            {
                jobId: 5,
                title: 'Junior Frontend Developer',
                companyName: 'MobileTech India',
                location: 'Chennai, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'ENTRY',
                minSalary: 400000,
                maxSalary: 600000,
                skills: 'HTML, CSS, JavaScript, React, Bootstrap',
                isRemote: false,
                viewsCount: 423,
                postedDate: '2026-01-09'
            },
            {
                jobId: 6,
                title: 'Cybersecurity Analyst',
                companyName: 'SecureNet Technologies',
                location: 'Delhi, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'MID',
                minSalary: 900000,
                maxSalary: 1600000,
                skills: 'Network Security, Penetration Testing, SIEM, Firewall',
                isRemote: false,
                viewsCount: 98,
                postedDate: '2026-01-04'
            },
            {
                jobId: 7,
                title: 'React Native Developer',
                companyName: 'MobileTech India',
                location: 'Bangalore, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'MID',
                minSalary: 1000000,
                maxSalary: 1800000,
                skills: 'React Native, JavaScript, Redux, REST APIs, Firebase',
                isRemote: true,
                viewsCount: 178,
                postedDate: '2026-01-03'
            },
            {
                jobId: 8,
                title: 'Machine Learning Engineer',
                companyName: 'Innovate Labs',
                location: 'Mumbai, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'SENIOR',
                minSalary: 1800000,
                maxSalary: 3000000,
                skills: 'Python, TensorFlow, Deep Learning, NLP, Computer Vision',
                isRemote: true,
                viewsCount: 267,
                postedDate: '2026-01-02'
            },
            {
                jobId: 9,
                title: 'Backend Developer (Node.js)',
                companyName: 'TechCorp Solutions',
                location: 'Hyderabad, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'MID',
                minSalary: 800000,
                maxSalary: 1400000,
                skills: 'Node.js, Express.js, MongoDB, PostgreSQL, Redis',
                isRemote: false,
                viewsCount: 134,
                postedDate: '2026-01-01'
            },
            {
                jobId: 10,
                title: 'UI/UX Designer',
                companyName: 'DataDriven Analytics',
                location: 'Pune, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'MID',
                minSalary: 700000,
                maxSalary: 1200000,
                skills: 'Figma, Adobe XD, Sketch, UI Design, User Research',
                isRemote: true,
                viewsCount: 201,
                postedDate: '2026-01-08'
            },
            {
                jobId: 11,
                title: 'Software Engineering Intern',
                companyName: 'CloudNine Systems',
                location: 'Bangalore, India',
                jobType: 'INTERNSHIP',
                experienceLevel: 'ENTRY',
                minSalary: 25000,
                maxSalary: 40000,
                skills: 'Java, Python, Data Structures, Algorithms, Git',
                isRemote: false,
                viewsCount: 567,
                postedDate: '2026-01-10'
            },
            {
                jobId: 12,
                title: 'Cloud Solutions Architect',
                companyName: 'CloudNine Systems',
                location: 'Mumbai, India',
                jobType: 'FULL_TIME',
                experienceLevel: 'SENIOR',
                minSalary: 2500000,
                maxSalary: 4000000,
                skills: 'AWS, Azure, GCP, Solution Design, Enterprise Architecture',
                isRemote: true,
                viewsCount: 89,
                postedDate: '2026-01-07'
            }
        ];

        document.addEventListener('DOMContentLoaded', function () {
            loadJobs();

            // Check URL params
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('keyword')) document.getElementById('keyword').value = urlParams.get('keyword');
            if (urlParams.get('location')) document.getElementById('location').value = urlParams.get('location');
        });

        document.getElementById('searchForm').addEventListener('submit', function (e) {
            e.preventDefault();
            currentPage = 0;
            loadJobs();
        });

        document.getElementById('sortBy').addEventListener('change', function () {
            loadJobs();
        });

        async function loadJobs() {
            const keyword = document.getElementById('keyword').value.toLowerCase();
            const location = document.getElementById('location').value.toLowerCase();
            const jobType = document.getElementById('jobType').value;
            const experienceLevel = document.getElementById('experienceLevel').value;

            // Filter dummy jobs based on search criteria
            let filteredJobs = dummyJobs.filter(job => {
                let match = true;
                if (keyword && !job.title.toLowerCase().includes(keyword) && !job.skills.toLowerCase().includes(keyword)) {
                    match = false;
                }
                if (location && !job.location.toLowerCase().includes(location)) {
                    match = false;
                }
                if (jobType && job.jobType !== jobType) {
                    match = false;
                }
                if (experienceLevel && job.experienceLevel !== experienceLevel) {
                    match = false;
                }
                return match;
            });

            // Sort jobs
            const sortBy = document.getElementById('sortBy').value;
            if (sortBy === 'viewsCount') {
                filteredJobs.sort((a, b) => b.viewsCount - a.viewsCount);
            } else if (sortBy === 'title') {
                filteredJobs.sort((a, b) => a.title.localeCompare(b.title));
            } else {
                filteredJobs.sort((a, b) => new Date(b.postedDate) - new Date(a.postedDate));
            }

            displayJobs(filteredJobs);
            document.getElementById('jobCount').textContent = filteredJobs.length;
        }

        function displayJobs(jobs) {
            const container = document.getElementById('jobsList');
            if (jobs.length === 0) {
                container.innerHTML = '<div class="col-12 text-center py-5"><h5>No jobs found</h5><p class="text-muted">Try adjusting your search criteria</p></div>';
                return;
            }

            container.innerHTML = jobs.map(job => {
                const skillBadges = job.skills.split(',').slice(0, 3).map(skill =>
                    '<span class="badge bg-light text-dark me-1 mb-1">' + skill.trim() + '</span>'
                ).join('');

                const remoteBadge = job.isRemote ? '<span class="badge bg-success ms-1">Remote</span>' : '';

                return `
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card job-card h-100 shadow-sm">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <span class="badge bg-primary">${job.jobType.replace('_', ' ')}</span>
                                ${remoteBadge}
                            </div>
                            <h5 class="card-title mb-2">${job.title}</h5>
                            <p class="text-muted mb-1"><i class="fas fa-building me-2"></i>${job.companyName}</p>
                            <p class="text-muted mb-1"><i class="fas fa-map-marker-alt me-2"></i>${job.location}</p>
                            <p class="text-success fw-bold mb-2"><i class="fas fa-rupee-sign me-2"></i>${formatSalary(job.minSalary, job.maxSalary)}</p>
                            <div class="mb-3">
                                ${skillBadges}
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-muted"><i class="fas fa-eye me-1"></i>${job.viewsCount} views</small>
                                <a href="/jobs/${job.jobId}" class="btn btn-primary btn-sm">
                                    <i class="fas fa-arrow-right me-1"></i>View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }

        function formatSalary(min, max) {
            if (!min && !max) return 'Not Disclosed';
            const formatNum = (num) => (num >= 100000) ? (num / 100000).toFixed(1) + ' LPA' : num.toLocaleString();
            if (min && max) return `${formatNum(min)} - ${formatNum(max)}`;
            return min ? formatNum(min) : formatNum(max);
        }

        function renderPagination(totalPages) {
            const pagination = document.querySelector('#pagination .pagination');
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            let html = `<li class="page-item ${currentPage === 0 ? 'disabled' : ''}">
                <a class="page-link" href="#" onclick="goToPage(${currentPage - 1})">Previous</a>
            </li>`;

            for (let i = 0; i < totalPages && i < 5; i++) {
                html += `<li class="page-item ${currentPage === i ? 'active' : ''}">
                    <a class="page-link" href="#" onclick="goToPage(${i})">${i + 1}</a>
                </li>`;
            }

            html += `<li class="page-item ${currentPage === totalPages - 1 ? 'disabled' : ''}">
                <a class="page-link" href="#" onclick="goToPage(${currentPage + 1})">Next</a>
            </li>`;

            pagination.innerHTML = html;
        }

        function goToPage(page) {
            currentPage = page;
            loadJobs();
            window.scrollTo(0, 0);
        }
    </script>
</body>

</html>